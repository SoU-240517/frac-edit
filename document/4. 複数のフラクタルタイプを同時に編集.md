[[機能要求書]]
***
## 4.1. 機能概要

- **目的:**  
    単一の編集データ内で複数のフラクタルタイプを組み合わせ、それぞれが相互に影響を与え合うことで、従来のフラクタルエディタでは表現しきれなかった、より複雑で多層的なパターンを生成する。
    
- **実現例:**
    - マンデルブロ集合の形状がジュリア集合のパラメータにより動的に変化する。
    - バーニングシップフラクタルとコラッツフラクタルを組み合わせ、それぞれの特徴を融合させた新たなパターンの生成。
    - 複数の異なるフラクタルタイプが、色や描画モードの違いを通じて互いに影響し、レイヤー構造を形成する。

- **効果:**  
    単一タイプでは不可能な多様で奥行きのあるフラクタルアートの創作が可能になり、ユーザーの創作自由度と表現力が大幅に向上する。
    
---
## 4.2. 影響関係の可視化

- **基本コンセプト:**  
    各フラクタルタイプ間の影響関係を、視覚的に理解しやすくするために、ノードエディタを活用して以下のような画面分割レイアウトで表示します。
    
- **画面分割構成:**
    - **左側：描画プレビューエリア**
        - キャンバス描画の簡易プレビューを表示し、ノード編集での変更がリアルタイムに反映される。
        - アスペクト比は常に維持され、全体のバランスを確認可能。
    - **右側：ノードエディタエリア**
        - フラクタルタイプを各ノードとして表示し、ノード同士の影響関係を接続線で表現。
        - ノード間の接続は、パラメータの直接参照や演算結果の参照など、関係性の種類ごとに色・太さ・形状を変えることで区別する。

- **画面分割比率:**
    - 初期状態では「描画プレビュー : ノードエディタ = 1 : 2」とし、中央の境界線をドラッグすることでユーザーが自由に調整可能。

- **連携:**
    - パラメータパネルでの編集内容は、即時にノードエディタにも反映され、影響関係の変化を視覚的に確認できるようにします。

---
## 4.3. 影響関係の設定ウィンドウ

- **基本機能:**  
    「ノード編集」タブ内のノードエディタエリアにおいて、各フラクタルタイプ間の影響関係を詳細に設定できる操作ウィンドウを提供します。
    
- **主な操作:**
    
    - **ノードの追加・削除:**
        - 新規フラクタルタイプをノードとして追加可能。
        - 不要なノードは削除し、編集データを整理できます。
    - **ノードの接続:**
        - ノード同士を線で接続し、どのパラメータがどのように参照されるかを設定するダイアログを表示。
        - 接続設定により、例えば「フラクタルAの反復回数の値をフラクタルBのズームに反映」といった具体的な影響関係を定義可能。
    - **接続の編集・削除:**
        - 既存の接続を選択し、パラメータや影響の種類の変更、もしくは接続そのものの削除が可能です。
    - **ノードの配置:**
        - ノードをドラッグ＆ドロップで自由に配置でき、影響関係を見やすく整理できます。
    - **ノードの検索・フィルタ:**
        - 多数のノードが存在する場合でも、目的のノードをキーワード検索やフィルタ機能で容易に見つけられるようにします。
    - **プリセットの保存・読み込み:**
        - 設定した影響関係の組み合わせをプリセットとして保存し、後で読み込みや共有が可能な仕組みを実装します。

---

## 4.4. 影響関係の具体例

- **例1: パラメータの連動:**
    - フラクタルAの「反復回数」をフラクタルBの「ズーム」パラメータとして使用。
    - 結果として、フラクタルAの形状が変化するたびに、フラクタルBの拡大率が動的に変化する表現が可能。

- **例2: 演算結果の利用:**
    - フラクタルAの「位置X」とフラクタルBの「位置Y」の平均値を計算し、その結果をフラクタルCの「色相」パラメータとして適用。
    - 位置情報に基づいた色変化を実現し、統一感のあるパターンが生成される。

- **例3: 複数パラメータの組み合わせ:**
    - フラクタルAの「スケール」とフラクタルBの「回転角度」を掛け合わせた結果を、フラクタルCの「変形」パラメータに反映。
    - 複数の影響を同時に受けることで、より複雑で予測不能な変形パターンが生じる。

---
## 4.5. UIデザインのポイント

- **視覚的連続性:**
    - ノードエディタと描画プレビューを同一画面内で配置し、編集内容と結果の関連性を直感的に把握できるようにします。

- **直感的な操作:**
    - ノードの追加、接続、編集はマウス操作でスムーズに行えるようにし、ツールチップやコンテキストメニューで補助情報を提供します。

- **視覚的な明確性:**
    - ノードの色分け、接続線のスタイル（色、太さ、線種）などを用い、影響関係の種類や方向を一目で認識可能にします。

- **リアルタイムプレビュー:**
    - ノードエディタでの操作結果は左側の描画プレビューに即時反映され、変更の影響をその場で確認できます。

- **柔軟なレイアウト:**
    - 画面中央の境界線をドラッグしてプレビューエリアとノードエディタエリアの比率を調整可能。
    - アスペクト比を維持しつつ、視認性の高いレイアウトを実現します。

- **カスタマイズ性:**
    - ユーザーがノードや接続線の表示スタイル、背景色などを好みに合わせて変更できるオプションを提供します。

---
