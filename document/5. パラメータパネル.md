[[機能要求書]]
***

## 5.1. パネルの配置と構成

パラメータパネルは、メインウィンドウの右側に常に固定表示されます。

この配置により、ユーザーはキャンバス描画を常に視界に入れながら、パラメータの調整を行うことができます。

パネル内は、主に以下の要素で構成されることを想定しています。

- **フラクタルタイプ選択**:
	現在編集中のフラクタルタイプをドロップダウンリストなどで選択できるようにします。
	複数のフラクタルタイプを同時に編集する機能と連携し、編集対象を切り替える役割を担います。
	
- **パラメータリスト**:
	選択されたフラクタルタイプが持つパラメータをリスト形式で表示します。
	パラメータの種類に応じて、入力フィールド、スライダー、チェックボックスなどのUI要素を適切に配置します。
	
- **全体ビュー縮小表示**:
	機能要求書「1. キャンバス操作」で言及されている全体ビューの縮小表示をパネル内に組み込みます。
	描画範囲の矩形表示と合わせて、現在の表示領域を常に把握できるようにします。
	
- **「作品描画」ボタン**:
	機能要求書「2. 高解像度レンダリング（作品描画）」で言及されている「作品描画」ボタンをパネル下部などに配置します。

_（イメージ図：フラクタルエディタの右側にパラメータパネルが表示されているUI。パネル上部にはフラクタルタイプ選択ドロップダウン、中央にパラメータリスト（入力フィールド、スライダー）、下部に全体ビュー縮小表示と「作品描画」ボタンが配置されている。）_

### 5.2. 詳細なパラメータ調整

パラメータパネルの主要な機能は、各フラクタルタイプの詳細なパラメータ調整です。

ユーザーはパラメータパネルを通して、フラクタルの形状、色、質感などを細かくコントロールし、創造性を最大限に発揮できます。

**5.2.1. 多様なUI要素**

パラメータの種類に応じて、以下のUI要素を使い分け、最適な操作性を提供します。

- **入力フィールド**: 数値や数式を直接入力できるテキストフィールドです。
    
    - **数値**: 数値パラメータ（例：反復回数、ズーム倍率、角度など）に対して使用します。
    - **数式**: より高度なパラメータ制御のために、簡単な数式（例： `param1 * 0.5 + param2` ）を入力できるようにします。数式入力の可否は、パラメータの種類によって設定できるようにします。
    - **リアルタイム評価**: 入力された数式は、確定後または一定時間経過後にリアルタイムに評価され、描画に反映されます。
- **スライダー**: 連続的な値の変化を直感的に操作できるスライダーです。
    
    - **範囲設定**: パラメータの適切な範囲に合わせて、スライダーの最小値・最大値を設定します。
    - **ステップ**: 必要に応じて、スライダーのステップ値を設定し、微調整をしやすくします。
    - **数値表示**: スライダーの横に現在の数値を表示し、正確な値を確認できるようにします。
- **チェックボックス**: Boolean値（真偽値）を切り替えるチェックボックスです。
    
    - **ON/OFF**: パラメータの有効/無効を切り替える場合に使用します。（例：特定のエフェクトのON/OFF）
- **カラースウォッチ**: 色を選択するためのカラースウォッチです。
    
    - **カラーピッカー**: クリックするとカラーピッカーがポップアップし、詳細な色選択を可能にします。
    - **グラデーション選択**: グラデーションエディタで作成したグラデーションをリスト表示し、選択できるようにします。
- **ドロップダウンリスト**: 複数の選択肢から一つを選ぶドロップダウンリストです。
    
    - **アルゴリズム選択**: カラーリングアルゴリズム、描画モード、フィルター、エフェクトの種類などを選択する場合に使用します。

**5.2.2. パラメータ編集の確定とリアルタイム描画**

パラメータの編集は、以下のタイミングで確定され、描画に反映されます。

- **一定時間経過後**: 入力フィールドやスライダー操作後、一定時間（例：0.3秒）操作が途絶えたら、自動的に編集を確定し、再描画を行います。これにより、スムーズなリアルタイムプレビューを実現します。
- **リターンキーによる確定**: 入力フィールドで値を編集後、リターンキーを押すことで明示的に編集を確定し、再描画を行います。
- **入力フィールドのフォーカスアウト**: 入力フィールドからフォーカスが外れたタイミングで編集を確定し、再描画を行います。

上記いずれかのタイミングで編集が確定すると、直ちに簡易描画が実行され、キャンバスに結果が反映されます。

これにより、パラメータ調整の結果をリアルタイムに確認しながら、試行錯誤を繰り返すことが可能です。

**5.2.3. パラメータのグルーピングと階層化**

パラメータの種類が多くなる場合、パラメータパネルが縦長になり、視認性や操作性が低下する可能性があります。

そのため、以下の方法でパラメータを整理することを検討します。

- **カテゴリ分け**: パラメータを機能や種類ごとにカテゴリ分けし、**展開/折りたたみ可能なグループ**として表示します。（例：「形状パラメータ」「カラーパラメータ」「エフェクトパラメータ」など）
- **階層構造**: カテゴリの中にさらにサブカテゴリを作成し、**階層的な構造** でパラメータを整理します。
- **検索機能**: パラメータ名で検索できる検索フィールドを設置し、目的のパラメータに素早くアクセスできるようにします。

_（イメージ図：パラメータパネル内で、パラメータが「形状パラメータ」「カラーパラメータ」「エフェクトパラメータ」などのカテゴリに分けられ、それぞれが展開/折りたたみ可能になっている様子。一部のカテゴリはさらにサブカテゴリに分かれている。）_

### 5.3. パラメータの保存と読み込み

作成したパラメータセットをファイルとして**保存**、および保存したファイルを**読み込み** できます。

- **パラメータプリセット**: よく使うパラメータ設定や、特定のフラクタルタイプに最適な設定などをプリセットとして保存しておくことで、効率的な作品制作を支援します。
- **ファイル形式**: パラメータファイルは、テキスト形式（JSON、YAMLなど）またはバイナリ形式で保存することを検討します。テキスト形式は可読性が高く、手動編集やバージョン管理システムとの連携が容易です。バイナリ形式はファイルサイズを小さくでき、読み込み速度が速いという利点があります。
- **保存場所**: パラメータファイルは、ユーザーが任意の場所に保存できるようにします。また、エディタの設定フォルダ内にプリセットフォルダを作成し、初期プリセットやユーザーが作成したプリセットを管理できるようにすることを検討します。
- **読み込み方法**: 「ファイル」メニューから「パラメータ読み込み」を選択する方法以外に、パラメータパネル内に「読み込み」ボタンを配置することも検討します。また、プリセットフォルダ内のファイルをドラッグ＆ドロップで読み込めるようにすることも考えられます。

### 5.4. UIデザインのポイント

パラメータパネルのUIデザインにおいては、以下の点を重視したいと考えています。

- **常に表示**: メインウィンドウ右側に常に表示することで、パラメータ調整へのアクセスを容易にし、ワークフローをスムーズにします。
- **視認性の高さ**: パラメータ名、UI要素、値などが整理され、一覧性が高く、目的のパラメータを素早く見つけられるようにします。
- **直感的な操作性**: 入力フィールド、スライダー、カラースウォッチなど、パラメータの種類に応じた適切なUI要素を使用し、直感的で快適なパラメータ調整を実現します。
- **リアルタイムプレビュー**: パラメータ編集の結果がリアルタイムにキャンバスに反映されることで、視覚的なフィードバックを即座に得られ、効率的な試行錯誤をサポートします。
- **カスタマイズ性**: パラメータパネルの表示項目、レイアウト、カラースキームなどをカスタマイズできるようにすることで、ユーザーの好みに合わせた作業環境を提供します。

---

以上が、「5. パラメータパネル」の詳細説明となります。

ご不明な点や、さらに詳しく知りたい点などございましたら、お気軽にご質問ください。